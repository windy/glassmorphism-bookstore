<div class="space-y-6">
  <!-- Header -->
  <div class="flex justify-between items-start">
    <div>
      <h1 class="text-3xl font-bold text-gray-900">Order #<%= @order.id %></h1>
      <p class="text-gray-600 mt-1">Created on <%= @order.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
    </div>
    <div class="flex space-x-3">
      <%= link_to "← Back to Orders", admin_orders_path, class: "btn btn-ghost" %>
      <%= link_to "Delete Order", admin_order_path(@order), 
          method: :delete,
          data: { 
            confirm: "Are you sure you want to delete this order? This action cannot be undone." 
          },
          class: "btn btn-error" %>
    </div>
  </div>

  <!-- Status and Quick Info -->
  <div class="bg-white rounded-lg shadow p-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="text-center">
        <div class="text-sm text-gray-500 mb-2">Status</div>
        <span class="badge badge-<%= @order.status == 'paid' ? 'success' : @order.status == 'failed' ? 'error' : 'warning' %> badge-lg">
          <%= @order.display_status %>
        </span>
      </div>
      <div class="text-center">
        <div class="text-sm text-gray-500 mb-2">Total Amount</div>
        <div class="text-2xl font-bold text-gray-900"><%= @order.formatted_amount %></div>
      </div>
      <div class="text-center">
        <div class="text-sm text-gray-500 mb-2">Payment Method</div>
        <div class="text-lg text-gray-900">
          <% if @order.stripe_payment_intent_id.present? %>
            <span class="flex items-center justify-center">
              Credit Card (Stripe)
            </span>
          <% else %>
            Pending
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Customer Information -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Customer Information</h3>
      </div>
      <div class="p-6 space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-500">Customer Name</label>
          <p class="mt-1 text-lg text-gray-900"><%= @order.customer_name %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-500">Email Address</label>
          <p class="mt-1 text-lg text-gray-900">
            <a href="mailto:<%= @order.customer_email %>" class="text-blue-600 hover:text-blue-800">
              <%= @order.customer_email %>
            </a>
          </p>
        </div>
      </div>
    </div>

    <!-- Order Information -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Product & Payment</h3>
      </div>
      <div class="p-6 space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-500">Product Name</label>
          <p class="mt-1 text-lg text-gray-900"><%= @order.product_name %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-500">Amount</label>
          <p class="mt-1 text-2xl font-bold text-green-600"><%= @order.formatted_amount %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-500">Currency</label>
          <p class="mt-1 text-lg text-gray-900 uppercase"><%= @order.currency %></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment Details -->
  <div class="bg-white rounded-lg shadow">
    <div class="px-6 py-4 border-b border-gray-200">
      <h3 class="text-lg font-medium text-gray-900">Payment Details</h3>
    </div>
    <div class="p-6">
      <% if @order.stripe_payment_intent_id.present? %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-500">Stripe Payment Intent ID</label>
            <p class="mt-1 text-sm text-gray-900 font-mono bg-gray-100 p-2 rounded">
              <%= @order.stripe_payment_intent_id %>
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500">Payment Status</label>
            <p class="mt-1 text-lg text-gray-900"><%= @order.display_status %></p>
          </div>
        </div>
        
        <% if @order.paid? %>
          <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-md">
            <div class="flex">
              <div>
                <p class="text-sm font-medium text-green-800">Payment Successful</p>
                <p class="text-sm text-green-700">This order has been paid and processed successfully.</p>
              </div>
            </div>
          </div>
        <% elsif @order.failed? %>
          <div class="mt-6 p-4 bg-red-50 border border-red-200 rounded-md">
            <div class="flex">
              <div>
                <p class="text-sm font-medium text-red-800">Payment Failed</p>
                <p class="text-sm text-red-700">The payment for this order could not be processed.</p>
              </div>
            </div>
          </div>
        <% elsif @order.processing? %>
          <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md">
            <div class="flex">
              <div>
                <p class="text-sm font-medium text-blue-800">Payment Processing</p>
                <p class="text-sm text-blue-700">This payment is currently being processed by Stripe.</p>
              </div>
            </div>
          </div>
        <% end %>
      <% else %>
        <div class="text-center py-8">
          <h3 class="mt-2 text-sm font-medium text-gray-900">No Payment Information</h3>
          <p class="mt-1 text-sm text-gray-500">This order doesn't have associated payment information yet.</p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Order Timeline -->
  <div class="bg-white rounded-lg shadow">
    <div class="px-6 py-4 border-b border-gray-200">
      <h3 class="text-lg font-medium text-gray-900">Order Timeline</h3>
    </div>
    <div class="p-6">
      <div class="flow-root">
        <ul class="-mb-8">
          <li>
            <div class="relative pb-8">
              <div class="absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200" aria-hidden="true"></div>
              <div class="relative flex space-x-3">
                <div>
                  <span class="h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center ring-8 ring-white">
                    <span class="text-white text-sm">1</span>
                  </span>
                </div>
                <div class="min-w-0 flex-1">
                  <div>
                    <div class="text-sm">
                      <span class="font-medium text-gray-900">Order Created</span>
                    </div>
                    <p class="mt-0.5 text-sm text-gray-500">
                      <%= @order.created_at.strftime("%B %d, %Y at %I:%M %p") %>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </li>
          
          <% if @order.stripe_payment_intent_id.present? %>
            <li>
              <div class="relative pb-8">
                <div class="absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200" aria-hidden="true"></div>
                <div class="relative flex space-x-3">
                  <div>
                    <span class="h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center ring-8 ring-white">
                      <span class="text-white text-sm">2</span>
                    </span>
                  </div>
                  <div class="min-w-0 flex-1">
                    <div>
                      <div class="text-sm">
                        <span class="font-medium text-gray-900">Payment Intent Created</span>
                      </div>
                      <p class="mt-0.5 text-sm text-gray-500">
                        Stripe payment session initiated
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          <% end %>
          
          <li>
            <div class="relative">
              <div class="relative flex space-x-3">
                <div>
                  <span class="h-8 w-8 rounded-full 
                    <%= @order.status == 'paid' ? 'bg-green-500' : @order.status == 'failed' ? 'bg-red-500' : 'bg-yellow-500' %>
                    flex items-center justify-center ring-8 ring-white">
                    <span class="text-white text-sm">3</span>
                  </span>
                </div>
                <div class="min-w-0 flex-1">
                  <div>
                    <div class="text-sm">
                      <span class="font-medium text-gray-900">Current Status: <%= @order.display_status %></span>
                    </div>
                    <p class="mt-0.5 text-sm text-gray-500">
                      Last updated <%= time_ago_in_words(@order.updated_at) %> ago
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>